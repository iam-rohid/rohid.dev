---
import BlogPostCard from "@/components/BlogPostCard.astro";
import Link from "@/components/Link.astro";
import MetaTags from "@/components/MetaTags.astro";
import ProjectCard from "@/components/ProjectCard.astro";
import HomeLayout from "@/layouts/HomeLayout.astro";
import { getCollection } from "astro:content";
import dayjs from "dayjs";

const blogPosts = await getCollection("blog", ({ data }) => {
  return import.meta.env.PROD ? data.isDraft !== true : true;
});
const recentBlogPosts = blogPosts
  .sort((a, b) =>
    dayjs(a.data.publishDate).isBefore(b.data.publishDate) ? 1 : -1
  )
  .slice(0, 5);
const projects = await getCollection("projects");
const topProjects = projects
  .sort((a, b) =>
    a.data.weight > b.data.weight ? -1 : b.data.weight > a.data.weight ? 1 : 0
  )
  .slice(0, 3);
---

<HomeLayout>
  <MetaTags
    title="Hi, Iâ€™m Rohid ðŸ‘‹"
    description="Hi, Iâ€™m Rohid, a Full-Stack Freelance Developer from Bangladesh. I build interactive web and mobile apps with a focus on great UI/UX. I love exploring new tech, contributing to open source, and creating tools for developers."
    keywords={[
      "Rohid",
      "rohid.dev",
      "MD Rohidul Islam",
      "Rohidul Islam",
      "developr",
      "Programmer",
      "React Developer",
      "React Native Developer",
    ]}
    slot="head"
  />

  <main
    class="container mx-auto my-8 max-w-(--breakpoint-md) space-y-16 px-4 md:px-8"
  >
    <section class="main-content">
      <h2 class="font-semibold mb-4">About Me</h2>
        <p class="leading-relaxed mb-2">
          Hi, Iâ€™m <b>Rohid</b>, a Full-Stack Freelance Developer from <b>Bangladesh</b>. I build modern web and mobile apps with a focus on clean design and great UX.
        </p>
        <p class="leading-relaxed mb-2">Currently building <Link href="https://siteassist.io?ref=rohid.dev" external>SiteAssist.io</Link> â€” an AI platform that lets businesses add intelligent assistants to their websites.</p>
        <p class="leading-relaxed">I love exploring new tech, contributing to open source, and creating tools that make developersâ€™ lives easier. Say hi on <Link href="https://x.com/rohiddev" external>@rohiddev</Link>!</p>
    </section>

    <section class="space-y-4">
      <div class="flex items-center gap-2">
        <div class="flex-1">
          <h2 class="truncate font-semibold">Featured Projects</h2>
        </div>
        <a
          href="/projects"
          class="text-muted-foreground hover:text-foreground flex items-center font-medium transition-colors duration-200"
        >
          All Projects
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="ml-2 h-5 w-5"
            ><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg
          >
        </a>
      </div>

      <div class="-mx-4 grid">
        {topProjects.map((project) => <ProjectCard {project} />)}
      </div>
    </section>
    <section class="space-y-4">
      <div class="flex items-center">
        <div class="flex-1">
          <h2 class="truncate font-semibold">Recent Posts</h2>
        </div>
        <a
          href="/blog"
          class="text-muted-foreground hover:text-foreground flex items-center font-medium transition-colors duration-200"
          >All Posts <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="ml-2 h-5 w-5"
            ><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg
          ></a
        >
      </div>
      <div class="-mx-4 grid">
        {recentBlogPosts.map((post) => <BlogPostCard {post} />)}
      </div>
    </section>
  </main>
</HomeLayout>
